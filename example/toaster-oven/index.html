<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://alexmnr.github.io/techspark/example/toaster-oven/">
      
      
        <link rel="prev" href="../../staff-guides/staff-guide-example/">
      
      
      
        
      
      
      <link rel="icon" href="../../assets/star.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>ToasterOven - TechSpark Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#toaster-oven-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TechSpark Wiki" class="md-header__button md-logo" aria-label="TechSpark Wiki" data-md-component="logo">
      
  <img src="../../assets/star.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TechSpark Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ToasterOven
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../student-guides/general/" class="md-tabs__link">
          
  
  
  Student Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../staff-guides/general/" class="md-tabs__link">
          
  
  
  Staff Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Example Documentation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TechSpark Wiki" class="md-nav__button md-logo" aria-label="TechSpark Wiki" data-md-component="logo">
      
  <img src="../../assets/star.svg" alt="logo">

    </a>
    TechSpark Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Student Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Student Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../student-guides/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    General
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../student-guides/student-guide-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Staff Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Staff Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../staff-guides/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    General
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../staff-guides/student-worker-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Student Worker Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../staff-guides/fbs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FBS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../staff-guides/staff-guide-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Example Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Example Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ToasterOven
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ToasterOven
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wiring-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wiring Diagram
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actual-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Actual Setup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ladder-logic-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ladder Logic Control
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpp-rest-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        CPP &amp; Rest Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPP &amp; Rest Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpp-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cpp Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plcnext-engineer-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        PLCNext Engineer Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#website" class="md-nav__link">
    <span class="md-ellipsis">
      
        Website
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remote-grpc-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Remote GRPC Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remote GRPC Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wiring-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wiring Diagram
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actual-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Actual Setup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ladder-logic-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ladder Logic Control
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpp-rest-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        CPP &amp; Rest Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPP &amp; Rest Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpp-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cpp Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plcnext-engineer-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        PLCNext Engineer Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#website" class="md-nav__link">
    <span class="md-ellipsis">
      
        Website
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remote-grpc-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Remote GRPC Control
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Remote GRPC Control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation">
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    Example Documentation
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="toaster-oven-example">Toaster Oven Example</h1>
<p>This example is supposed so showcase multiple capabilites of the plcnext system. The overarching goal is to control the temperature of an oven with a heater and fan, while reading the current temperature with a thermocouple. The fan and heater are both conrolled with industrial relays and the k-type thermocouple is connected through a transducer.</p>
<h2 id="wiring-diagram">Wiring Diagram</h2>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-1.svg" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-1.svg"></a></p>
<h2 id="actual-setup">Actual Setup</h2>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-2.jpg" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-2.jpg"></a>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-3.jpg" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-3.jpg"></a>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-4.jpg" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-4.jpg"></a>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-5.jpg" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-5.jpg"></a>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-6.jpg" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-6.jpg"></a></p>
<h2 id="ladder-logic-control">Ladder Logic Control</h2>
<p>The following code converts the slider input of the starterkit into a temperature input and turns the system on when button s3 is pressed and turned off when button s2 is pressed. The heater is turned on when the set temperature is higher than the current temperature (plus a buffer). The fan is turned on when the set temperature is less than the current temperature (minus a buffer).</p>
<p>To run this example open the <strong>ToasterOvenLadderLogic.pcwex</strong> project and upload it. Enter debug mode to observe the controller logic.</p>
<p>Ladder Logic Code:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-7.png" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-7.png"></a></p>
<p>Variables:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-8.png" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-8.png"></a></p>
<h2 id="cpp-rest-control">CPP &amp; Rest Control</h2>
<p>This example showcases two things: First, it implements the exact same logic as the ladder logic example, with a real-time cyclic cpp program. Secondly, it has the ability to overwrite the heater control using the button and slider on the hardware with a rest interface, where one can control the temperature of the oven using an example website provided.</p>
<p>More information on how this was implemented can be found in the <a href="../SimpleIOReadWrite/README.md">SimpleIOReadWrite Project</a> and the <a href="../RestCommunication/README.md">RestCommunication Project</a></p>
<p>To run this example open the <strong>ToasterOvenCppRest.pcwex</strong> Project and upload it. Then use the slider and buttons on the starterkit to control it or use the website as descibed below.</p>
<h3 id="cpp-code">Cpp Code</h3>
<p>Logic:</p>
<pre><code class="language-cpp">void ToasterOvenCppProgram::Execute()
{
    currentTemp = thermoInput * 0.058 - 100;

    if (restControl) {
        // control using rest
        on = true;
        setTemp = restSetTemp;

    } else {
        // control using hardware
        setTemp = sliderInput * 0.02;
        if (onButton || on) {
            on = true;
        }
        if (offButton) {
            on = false;
        }
    }

    if ((currentTemp + heatingBuffer) &lt; setTemp) {
        heating = true;
    } else {
        heating = false;
    }
    if ((currentTemp - coolingBuffer) &gt; setTemp) {
        cooling = true;
    } else {
        cooling = false;
    }

    if (heating &amp;&amp; on) {
        heaterOutput = true;
        fanOutput = false;
    } else if (cooling &amp;&amp; on) {
        heaterOutput = false;
        fanOutput = true;
    } else {
        heaterOutput = false;
        fanOutput = false;
    }

    log.Info("on: {0} heating: {1} cooling: {2} currentTemp: {3} setTemp: {4} REST: {5}", on, heating, cooling, currentTemp, setTemp, restControl);
}
</code></pre>
<p>Variables:</p>
<pre><code class="language-cpp">public:
    //#port
    //#attributes(Input)
    uint16 sliderInput;

    //#port
    //#attributes(Input)
    uint16 thermoInput;

    //#port
    //#attributes(Input)
    bool onButton;

    //#port
    //#attributes(Input)
    bool offButton;

    //#port
    //#attributes(Output)
    bool heaterOutput; // Output pin array (16 output pins)

    //#port
    //#attributes(Output)
    bool fanOutput; // Output pin array (16 output pins)

    //#port
    //#attributes(Input|Ehmi)
    float32 restSetTemp= 0;

    //#port
    //#attributes(Input|Ehmi)
    bool restControl = false;

    //#port
    //#attributes(Output|Ehmi)
    bool on = false;
    //#port
    //#attributes(Output|Ehmi)
    bool heating = false;
    //#port
    //#attributes(Output|Ehmi)
    bool cooling = false;

    //#port
    //#attributes(Output|Ehmi)
    float32 currentTemp;

    //#port
    //#attributes(Output|Ehmi)
    float32 setTemp;

private: // fields
    ToasterOvenCpp::ToasterOvenCppComponent&amp; toasterOvenCppComponent;

    double heatingBuffer = 5.0;
    double coolingBuffer = 5.0;

};
</code></pre>
<h3 id="plcnext-engineer-configuration">PLCNext Engineer Configuration</h3>
<p>GDS Port Configuration:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-9.png" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-9.png"></a></p>
<p>Cyclic Task Configuration:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-10.png" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-10.png"></a></p>
<h3 id="website">Website</h3>
<p>Follow the instructions from the <a href="../RestCommunication/README.md">RestCommunication Example</a> on using the CORS extension.</p>
<p>If used correctly, opening the index.html file in the website folder should look like this:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-12.png" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-12.png"></a></p>
<h2 id="remote-grpc-control">Remote GRPC Control</h2>
<p>This does exactly the same as the ladder logic example, but all computations are done on a remote device using python through grpc communication (see GrpcRemoteCommunication for more information <a href="../GrpcRemoteCommunication/README.md">here</a>)</p>
<p>To run this example open the <strong>ToasterOvenGrpc.pcwex</strong> project and upload it. On a remote device with python and linux follow the following steps.</p>
<ol>
<li>
<p>Install Dependencies (follow steps <a href="../GrpcRemoteCommunication/README.md#installing-dependencies">here</a>)</p>
</li>
<li>
<p>Compile protobuf (run within the python folder)</p>
</li>
</ol>
<pre><code class="language-sh">bash ./build_all.sh
</code></pre>
<ol>
<li>
<p>Configure Certificate (follow steps <a href="../GrpcRemoteCommunication/README.md#configuring-the-certificate">here</a>)</p>
</li>
<li>
<p>Get certificate from controller (follow steps <a href="../GrpcRemoteCommunication/README.md#downloading-the-certificate">here</a>)</p>
</li>
<li>
<p>Run the code</p>
</li>
</ol>
<pre><code class="language-sh">python3 example.py
</code></pre>
<p>Example Output:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/ToasterOven-11.png" data-desc-position="bottom"><img alt="image" src="../../assets/ToasterOven-11.png"></a></p>
<h3 id="code">Code:</h3>
<pre><code class="language-python">import grpc
import sys
import os
import time
import matplotlib.pyplot as plt
import numpy as np

# Get the absolute path to the directory containing the module and add it to the python path
module_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), 'ServiceStubs'))
sys.path.insert(0, module_dir)

## Import Protobuf librarys
from ServiceStubs.Plc.Gds.IDataAccessService_pb2_grpc import IDataAccessServiceStub
from ServiceStubs.Plc.Gds.IDataAccessService_pb2 import IDataAccessServiceReadRequest
# GDS Write Multiple
from ServiceStubs.Plc.Gds.IDataAccessService_pb2 import IDataAccessServiceWriteRequest
from ServiceStubs.Plc.Gds.WriteItem_pb2 import WriteItem

# function to read input from controller
def readInput(stub):
    item = IDataAccessServiceReadRequest()
    item.portNames.extend(['Arp.Plc.Eclr/sliderInput', 'Arp.Plc.Eclr/thermoInput', 'Arp.Plc.Eclr/onButton', 'Arp.Plc.Eclr/offButton'])
    response = stub.Read(item)
    sliderInput = response._ReturnValue[0].Value.Uint16Value
    thermoInput = response._ReturnValue[1].Value.Uint16Value
    onButton = response._ReturnValue[2].Value.BoolValue
    offButton = response._ReturnValue[3].Value.BoolValue
    return [sliderInput, thermoInput, onButton, offButton]

# function to write relays on controller 
def writeOutput(stub, heater, fan):
    request = IDataAccessServiceWriteRequest()
    item1 = WriteItem()
    item1.PortName = 'Arp.Plc.Eclr/heaterOutput'
    item1.Value.BoolValue = heater
    item1.Value.TypeCode = 2
    item2 = WriteItem()
    item2.PortName = 'Arp.Plc.Eclr/fanOutput'
    item2.Value.BoolValue = fan
    item2.Value.TypeCode = 2
    request.data.extend([item1, item2])
    return stub.Write(request)

###### Setup Graph
# Initialize the data containers
x_data = []
y1_data = []
y2_data = []
start_time = time.perf_counter()

# Set up the plot
plt.ion()
fig, ax = plt.subplots()
line1, = ax.plot([], [], 'r-', label='Set')
line2, = ax.plot([], [], 'g-', label='Current')

ax.legend()
plt.xlabel('Time')
plt.ylabel('Temperature')
ax.set_ylim(20, 200)

###### Create GRPC Connection
# read certificate
with open('certificate.pem', 'rb') as f:
    root_certificates = f.read()

# open channel and check for health
addr = "192.168.1.10:50051"
cred = grpc.ssl_channel_credentials(root_certificates=root_certificates)
channel = grpc.secure_channel(addr, cred)
try:
    grpc.channel_ready_future(channel).result(timeout=5)
except grpc.FutureTimeoutError:
    sys.exit('Error connecting to server')

# Create IDataAccessServiceStub
stub = IDataAccessServiceStub(channel)

###### Main Control
# turn off everything
writeOutput(stub, False, False)
# variables
on = False
heating = False
cooling = False
heatingBuffer = 5.0
coolingBuffer = 5.0

while (1):
    # get input from controller
    sliderInput, thermoInput, onButton, offButton = readInput(stub)

    # calculate temperatures
    currentTemp = np.round(thermoInput * 0.058 - 100, 1)
    setTemp = np.round((sliderInput / 10000) * 200, 1)

    # turn system on or off
    if (onButton and not offButton) or (on):
        on = True
    if offButton:
        on = False

    # decide wheter to heat or cool oven
    if (currentTemp + heatingBuffer) &lt; setTemp:
        heating = True
    else:
        heating = False

    if (currentTemp - coolingBuffer) &gt; setTemp:
        cooling = True
    else:
        cooling = False

    # turn on heater or fan
    if heating and on:
        mode = "Heating"
        writeOutput(stub, True, False)
    elif cooling and on:
        mode = "Cooling"
        writeOutput(stub, False, True)
    else:
        mode = "Idle"
        writeOutput(stub, False, False)
    if not on:
        mode = "Off"
        writeOutput(stub, False, False)

    # print status
    print(f"Mode: {mode} SetTemp: {setTemp} currentTemp: {currentTemp}")

    # graph stuff
    end_time = time.perf_counter()

    # Append new data
    x_data.append(end_time - start_time)
    y1_data.append(setTemp)
    y2_data.append(currentTemp)

    # Update the data in the line objects
    line1.set_xdata(x_data)
    line1.set_ydata(y1_data)
    line2.set_xdata(x_data)
    line2.set_ydata(y2_data)

    # Adjust limits if data goes out of view
    ax.relim()
    ax.autoscale_view()

    # Draw and flush events
    fig.canvas.draw()
    fig.canvas.flush_events()

    time.sleep(0.05) 

</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.path"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>